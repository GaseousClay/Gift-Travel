---
title: "Tables and Figures"
tables: yes
output:
  pdf_document: default
---

\begin{table}[h]
\centering
\caption{Predicted Number of Trips}
\label{}
\begin{tabular}{@{}lll@{}}
\toprule
                            & No                 & Yes                 \\ \midrule
Committee Chair             & 2.58              & 5.52              \\
                            & {[}2.33 - 2.85{]} & {[}4.62 - 6.59{]} \\
Democrat                    & 2.58              & 2.17              \\
                            & {[}2.33 - 2.85{]} & {[}1.97 - 2.39{]} \\
Party Leader                & 2.58              & 5.49              \\
                            & {[}2.33 - 2.85{]} & {[}4.20 - 7.17{]} \\
Ranking Member (Republican) & 2.58              & 4.83              \\
                            & {[}2.33 - 2.85{]} & {[}3.75 - 6.22{]} \\
Ranking Member (Democratic) & 2.17              & 2.49              \\
                            & {[}1.97 - 2.39{]} & {[}1.98 - 3.15{]} \\ \bottomrule
\multicolumn{2}{l}{\footnotesize Note: Standard errors reported in brackets.}    \\
\end{tabular}
\end{table}




```{r, echo = F, warning = F, message = F, fig.height = 3.3, fig.cap = "Predicted Trips Taken by Member per Congress"}
library(dplyr)
library(rio)
library(ggplot2)
library(MASS)
library(RColorBrewer)
#set up data and multiplot function
giftdata <- read.csv(file = "110-114Congresses.csv", header = TRUE, stringsAsFactors = FALSE)
finalmodel <- glm.nb(trips ~ extreme*democrat + winpct + committee*democrat + seniority + chairman + party.leader + fourteenth + thirteenth + twelfth + eleventh, data = giftdata)
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)

  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)

  numPlots = length(plots)

  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                    ncol = cols, nrow = ceiling(numPlots/cols))
  }

 if (numPlots==1) {
    print(plots[[1]])

  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))

    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))

      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

#predicted values
extremitydata <- data.frame(extreme = giftdata$extreme, democrat = 0, winpct = mean(giftdata$winpct), seniority = mean(giftdata$seniority), chairman = 0, committee = 0, party.leader = 0, fourteenth = 0, thirteenth = 0, twelfth = 0, eleventh = 0)
extremitydataD1 <- data.frame(extreme = giftdata$extreme, democrat = giftdata$democrat, winpct = mean(giftdata$winpct), seniority = mean(giftdata$seniority), chairman = 0, committee = 0, party.leader = 0, fourteenth = 0, thirteenth = 0, twelfth = 0, eleventh = 0)
extremitydataD1 <- filter(extremitydataD1, democrat == 1)
winpctdata <- data.frame(extreme = mean(giftdata$extreme), democrat = 0, winpct = giftdata$winpct, seniority = mean(giftdata$seniority), chairman = 0, committee = 0, party.leader = 0, fourteenth = 0, thirteenth = 0, twelfth = 0, eleventh = 0)
senioritydata <- data.frame(extreme = mean(giftdata$extreme), democrat = 0, winpct = mean(giftdata$winpct), seniority = giftdata$seniority, chairman = 0, committee = 0, party.leader = 0, fourteenth = 0, thirteenth = 0, twelfth = 0, eleventh = 0)
extremitydata$phat <- predict(finalmodel, extremitydata, type = "response")
extremitydataD1$phat <- predict(finalmodel, extremitydataD1, type = "response")
winpctdata$phat <- predict(finalmodel, winpctdata, type = "response")
senioritydata$phat <- predict(finalmodel, senioritydata, type = "response")

#prep for plots
extremitydataCI <- data.frame(extremitydata)
extremitydataCI <- cbind(extremitydataCI, predict(finalmodel, extremitydata, type = "link", se.fit = T))
extremitydataCI <- within(extremitydataCI, {
  Trips <- exp(fit)
  LL <- exp(fit - 1.96 * se.fit)
  UL <- exp(fit + 1.96 * se.fit)})

extremitydataD1CI <- data.frame(extremitydataD1)
extremitydataD1CI <- cbind(extremitydataD1CI, predict(finalmodel, extremitydataD1, type = "link", se.fit = T))
extremitydataD1CI <- within(extremitydataD1CI, {
  Trips <- exp(fit)
  LL <- exp(fit - 1.96 * se.fit)
  UL <- exp(fit + 1.96 * se.fit)})

winpctdataCI <- data.frame(winpctdata)
winpctdataCI <- cbind(winpctdataCI, predict(finalmodel, winpctdata, type = "link", se.fit = T))
winpctdataCI <- within(winpctdataCI, {
  Trips <- exp(fit)
  LL <- exp(fit - 1.96 * se.fit)
  UL <- exp(fit + 1.96 * se.fit)})

senioritydataCI <- data.frame(senioritydata)
senioritydataCI <- cbind(senioritydataCI, predict(finalmodel, senioritydata, type = "link", se.fit = T))
senioritydataCI <- within(senioritydataCI, {
  Trips <- exp(fit)
  LL <- exp(fit - 1.96 * se.fit)
  UL <- exp(fit + 1.96 * se.fit)})

#plots
mypalette <- brewer.pal(1,"Greys")
p1 <- ggplot(extremitydataCI, aes(extreme, Trips)) +
  geom_ribbon(aes(ymin = LL, ymax = UL, fill = democrat), alpha = .25) +
  geom_line(aes(colour = committee), size = 1) +
  labs(x = "Ideological Extremity", y = "Pred. Trips: GOP") + guides(colour=FALSE, fill=FALSE) + scale_fill_distiller(palette = mypalette, type = "seq") + scale_color_distiller(palette = mypalette, type = "seq") + theme_classic() + ylim(0,6)
p2 <- ggplot(extremitydataD1CI, aes(extreme, Trips)) +
  geom_ribbon(aes(ymin = LL, ymax = UL, fill = chairman), alpha = .25) +
  geom_line(aes(colour = party.leader), size = 1) +
  labs(x = "Ideological Extremity", y = "Pred. Trips: Dem.") + guides(colour=FALSE, fill=FALSE) + scale_fill_distiller(palette = mypalette, type = "seq") + scale_color_distiller(palette = mypalette, type = "seq") + theme_classic() + ylim(0,6)
p3 <- ggplot(winpctdataCI, aes(winpct, Trips)) +
  geom_ribbon(aes(ymin = LL, ymax = UL, fill = committee), alpha = .25) +
  geom_line(aes(colour = committee), size = 1) +
  labs(x = "Win Percentage", y = "Predicted Trips") + guides(colour=FALSE, fill=FALSE) + scale_fill_distiller(palette = mypalette, type = "seq") + scale_color_distiller(palette = mypalette, type = "seq") + theme_classic() + ylim(0,6)
p4 <- ggplot(senioritydataCI, aes(seniority, Trips)) +
  geom_ribbon(aes(ymin = LL, ymax = UL, fill = fourteenth), alpha = .25) +
  geom_line(aes(colour = fourteenth), size = 1) +
  labs(x = "Terms Served in the House", y = "Predicted Trips") + guides(colour=FALSE, fill=FALSE) + scale_fill_distiller(palette = mypalette, type = "seq") + scale_color_distiller(palette = mypalette, type = "seq") + theme_classic() + ylim(0,6)

multiplot(p1, p3, p2, p4, cols=2)
```